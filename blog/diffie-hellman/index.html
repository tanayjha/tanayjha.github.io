<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Diffie Hellman Key Exchange | </title><meta name=keywords content><meta name=description content="Recently I had the opportunity to read about the Diffie Hellman key exchange and found it to be fascinating. The beauty of it lies in its simplicity. Of course there is some complicated number theory involved, but overall it is pretty easy to grasp the concept intuitively as well. So let&rsquo;s start with it&mldr;
What? Diffie-Hellman key exchange is a method of digital encryption that securely exchanges cryptographic keys between two parties over a public channel without their conversation being transmitted over the internet."><meta name=author content><link rel=canonical href=https://tanayjha.github.io/blog/diffie-hellman/><link crossorigin=anonymous href=/assets/css/stylesheet.d7fb4cbf980fe688a21621b06a795933c4e6bb2d4070ec940667af1715d84af2.css integrity="sha256-1/tMv5gP5oiiFiGwanlZM8Tmuy1AcOyUBmevFxXYSvI=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://tanayjha.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tanayjha.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tanayjha.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://tanayjha.github.io/apple-touch-icon.png><link rel=mask-icon href=https://tanayjha.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://tanayjha.github.io/blog/diffie-hellman/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Diffie Hellman Key Exchange"><meta property="og:description" content="Recently I had the opportunity to read about the Diffie Hellman key exchange and found it to be fascinating. The beauty of it lies in its simplicity. Of course there is some complicated number theory involved, but overall it is pretty easy to grasp the concept intuitively as well. So let&rsquo;s start with it&mldr;
What? Diffie-Hellman key exchange is a method of digital encryption that securely exchanges cryptographic keys between two parties over a public channel without their conversation being transmitted over the internet."><meta property="og:type" content="article"><meta property="og:url" content="https://tanayjha.github.io/blog/diffie-hellman/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2023-02-03T00:24:13+05:30"><meta property="article:modified_time" content="2023-02-03T00:24:13+05:30"><meta name=twitter:card content="summary"><meta name=twitter:title content="Diffie Hellman Key Exchange"><meta name=twitter:description content="Recently I had the opportunity to read about the Diffie Hellman key exchange and found it to be fascinating. The beauty of it lies in its simplicity. Of course there is some complicated number theory involved, but overall it is pretty easy to grasp the concept intuitively as well. So let&rsquo;s start with it&mldr;
What? Diffie-Hellman key exchange is a method of digital encryption that securely exchanges cryptographic keys between two parties over a public channel without their conversation being transmitted over the internet."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://tanayjha.github.io/blog/"},{"@type":"ListItem","position":2,"name":"Diffie Hellman Key Exchange","item":"https://tanayjha.github.io/blog/diffie-hellman/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Diffie Hellman Key Exchange","name":"Diffie Hellman Key Exchange","description":"Recently I had the opportunity to read about the Diffie Hellman key exchange and found it to be fascinating. The beauty of it lies in its simplicity. Of course there is some complicated number theory involved, but overall it is pretty easy to grasp the concept intuitively as well. So let\u0026rsquo;s start with it\u0026hellip;\nWhat? Diffie-Hellman key exchange is a method of digital encryption that securely exchanges cryptographic keys between two parties over a public channel without their conversation being transmitted over the internet.","keywords":[],"articleBody":"Recently I had the opportunity to read about the Diffie Hellman key exchange and found it to be fascinating. The beauty of it lies in its simplicity. Of course there is some complicated number theory involved, but overall it is pretty easy to grasp the concept intuitively as well. So let’s start with it…\nWhat? Diffie-Hellman key exchange is a method of digital encryption that securely exchanges cryptographic keys between two parties over a public channel without their conversation being transmitted over the internet. The two parties use symmetric cryptography to encrypt and decrypt their messages. Published in 1976 by Whitfield Diffie and Martin Hellman, it was one of the first practical examples of public key cryptography.\nWhy? Diffie-Hellman key exchange’s goal is to securely establish a channel to create and share a key for symmetric key algorithms. Generally, it’s used for encryption, password-authenticated key agreement and forward security. Password-authenticated key agreements are used to prevent man-in-the-middle (MitM) attacks. Forward secrecy-based protocols protect against the compromising of keys by generating new key pairs for each session.\nDiffie-Hellman key exchange is commonly found in security protocols, such as Transport Layer Security (TLS), Secure Shell (SSH) and IP Security (IPsec). For example, in IPsec, the encryption method is used for key generation and key rotation.\nEven though Diffie-Hellman key exchange can be used for establishing both public and private keys, the Rivest-Shamir-Adleman algorithm, or RSA algorithm, can also be used, since it’s able to sign public key certificates.\nHow? This is the interesting part. How exactly can two people, Alice and Bob (our favorite), exchange a secret key which only they will know and agree upon by transmitting data over an insecure channel. To understand the diffie-hellman key-exchange, we will first need to learn a little bit about discrete logarithms and primite roots.\nDiscrete logarithm Consider the equation, y = gx mod p. If you are given g, x and p, it is pretty straightforward to calculate y. However, given y, g and p, it is, in general, very difficult to calculate x. This problem of calculating the value of x, is called taking the discrete logarithm of the number y for the base g (mod p) and denoted as dlogg,p(b). The difficulty of calculating this seems to be on the same order of magnitude as that of factoring primes required for RSA. At the time of this writing, the asymptotically fastest known algorithm for taking discrete logarithms modulo a prime number is on the order of: e((ln p)1/3(ln(ln p))2/3)) which is infeasible for large primes.\nPrimitve roots The figure below shows all the powers of a, modulo 19 for all positive a \u003c 19. The length of the sequence for each base value is indicated by shading.\nThe number of possible values when you take the mod of a number with 19, is 19 i.e [0-18]. So in the above table, all the numbers for which the shaded length = 19, are referred to as a primitive root of n. The importance of this notion is that if a is a primitive root of a prime p, then its powers a, a2, …, ap-1 are distinct (mod p). In particular, for a prime number p, if a is a primitive root of p, then For the prime number 19, its primitive roots are 2, 3, 10, 13, 14, and 15 as we can see from the figure above. There is more complicated math around primitve roots but lets not go into that in this blog post.\nThe Diffie-Hellman Algorithm The below figure shows the steps of diffie-hellman algorithm:\nThe idea behind the algorithm is pretty simple.\nFirst Alice and Bob agree upon a prime number q and a primitve root of q, say α such that α \u003c q. They both generate a private key Xa and Xb respectively such that both the keys are smaller than q. They both calculate their public keys Y = αX mod q and exchange that over the insecure channel. The key exchange is now done. They both calculate the shared secret key K = YX mod q. In order to convince ourselves that this actually works, there are a few questions we have to answer:\nIn the first step why does α \u003c q have to be a primitive root of q. After the calculations of public key are done and they are exchanged, how does step 4 generate the common secret key for both. How do we ensure that the transmission of public key over the insecure channel, does not compromise the secret key in any way. If we are able to answer the above questions, we can feel confident that we understand the diffie-hellman key exchange method well enough.\nSo lets start with the first question. Why do we need α to be a primitve root of q and why should it be strictly smaller than q. If you look at step 3, where they both calculate their public keys, they raise α to some power (of their selected private key which can be assumed to be different) and then take a (mod q). If α is a primitive root of q (less than q), we can be sure that the generated public keys will also be distinct (from the properties of primitive root we saw above). Hence selecting α \u003c q and a primitive root of q ensures uniqueness of the generated public keys. This also makes it harder to guess the shared secret key since the keys are in a random distribution and each key has equal probablity of occuring.\nFor the second question, how does step 4, i.e K = YX mod , guarantee that both Alice and Bob got the same key. The proof for that is pretty elementary and involves basic arithmatic.\nNow, for the final question. What happens if someone intercepts the public keys YA and YB shared by Alice and Bob? Can they figure out the shared secret key? In order to calculate the secret key XA/XB, the hacker will have to solve the discrete logarithm problem as they need to calculate X from the equation: Y = αX mod q. We have already seen above that calculating discrete log is a very hard problem and has similar complexity as factoring product of primes which is the basis of security for RSA. So we can confidently say that Diffie-Hellman is at least as secured as the RSA which is good enough for all practical purposes.\nConclusion So we now have a nice method of exchanging shared secret key securely which can be used in a lot of symmetric key encryption algorithms. Diffie-Hellman is also used in SSL/TLS, the protocols that secure web communication. So the usage is very widespread. Combining it with RSA is also one of the common use case of Diffie-Hellman. It is used to securely exchange the shared secret key, which is then used with RSA for encryption. This provides the security of key exchange from Diffie-Hellman and the encryption strength of RSA, making it a more secure solution than either method alone.\nHopefully this blog gives you the confidence you needed to say that you understand the Diffie-Hellman Key exchange.\nReferences Cryptography and Network Security by William Stallings. Introduction to Cryptography by Christof Paar (Youtube lecture) ","wordCount":"1215","inLanguage":"en","datePublished":"2023-02-03T00:24:13+05:30","dateModified":"2023-02-03T00:24:13+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"https://tanayjha.github.io/blog/diffie-hellman/"},"publisher":{"@type":"Organization","name":"","logo":{"@type":"ImageObject","url":"https://tanayjha.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Diffie Hellman Key Exchange</h1><div class=post-meta>&lt;span title='2023-02-03 00:24:13 +0530 +0530'>February 3, 2023&lt;/span>&amp;nbsp;·&amp;nbsp;6 min</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#what aria-label=What?>What?</a></li><li><a href=#why aria-label=Why?>Why?</a></li><li><a href=#how aria-label=How?>How?</a><ul><li><a href=#discrete-logarithm aria-label="Discrete logarithm">Discrete logarithm</a></li><li><a href=#primitve-roots aria-label="Primitve roots">Primitve roots</a></li></ul></li><li><a href=#the-diffie-hellman-algorithm aria-label="The Diffie-Hellman Algorithm">The Diffie-Hellman Algorithm</a></li><li><a href=#conclusion aria-label=Conclusion>Conclusion</a><ul><li><a href=#references aria-label=References>References</a></li></ul></li></ul></div></details></div><div class=post-content><p>Recently I had the opportunity to read about the Diffie Hellman key exchange and found it to be fascinating. The beauty of it lies in its simplicity. Of course there is some complicated number theory involved, but overall it is pretty easy to grasp the concept intuitively as well. So let&rsquo;s start with it&mldr;</p><h2 id=what>What?<a hidden class=anchor aria-hidden=true href=#what>#</a></h2><p>Diffie-Hellman key exchange is a method of digital encryption that securely exchanges cryptographic keys between two parties over a public channel without their conversation being transmitted over the internet. The two parties use symmetric cryptography to encrypt and decrypt their messages. Published in 1976 by Whitfield Diffie and Martin Hellman, it was one of the first practical examples of public key cryptography.</p><h2 id=why>Why?<a hidden class=anchor aria-hidden=true href=#why>#</a></h2><p>Diffie-Hellman key exchange&rsquo;s goal is to securely establish a channel to create and share a key for symmetric key algorithms. Generally, it&rsquo;s used for encryption, password-authenticated key agreement and forward security. Password-authenticated key agreements are used to prevent man-in-the-middle (MitM) attacks. Forward secrecy-based protocols protect against the compromising of keys by generating new key pairs for each session.</p><p>Diffie-Hellman key exchange is commonly found in security protocols, such as Transport Layer Security (TLS), Secure Shell (SSH) and IP Security (IPsec). For example, in IPsec, the encryption method is used for key generation and key rotation.</p><p>Even though Diffie-Hellman key exchange can be used for establishing both public and private keys, the Rivest-Shamir-Adleman algorithm, or RSA algorithm, can also be used, since it&rsquo;s able to sign public key certificates.</p><h2 id=how>How?<a hidden class=anchor aria-hidden=true href=#how>#</a></h2><p>This is the interesting part. How exactly can two people, Alice and Bob (our favorite), exchange a secret key which only they will know and agree upon by transmitting data over an insecure channel. To understand the diffie-hellman key-exchange, we will first need to learn a little bit about discrete logarithms and primite roots.</p><h3 id=discrete-logarithm>Discrete logarithm<a hidden class=anchor aria-hidden=true href=#discrete-logarithm>#</a></h3><p>Consider the equation, y = g<sup>x</sup> mod p. If you are given g, x and p, it is pretty straightforward to calculate y. However, given y, g and p, it is, in general, very difficult to calculate x. This problem of calculating the value of x, is called taking the discrete logarithm of the number y for the base g (mod p) and denoted as dlog<sub>g,p</sub>(b).
The difficulty of calculating this seems to be on the same order of magnitude as that of factoring primes required for RSA. At the time of this writing, the asymptotically fastest known algorithm for taking discrete logarithms modulo a prime number is on the order of: e<sup>((ln p)1/3(ln(ln p))2/3))</sup> which is infeasible for large primes.</p><h3 id=primitve-roots>Primitve roots<a hidden class=anchor aria-hidden=true href=#primitve-roots>#</a></h3><p>The figure below shows all the powers of a, modulo 19 for all positive a &lt; 19. The length of the sequence for each base value is indicated by shading.</p><figure><img loading=lazy src=/images/diffieHellman/primitveRoot.png></figure><p>The number of possible values when you take the mod of a number with 19, is 19 i.e [0-18]. So in the above table, all the numbers for which the shaded length = 19, are referred to as a primitive root of n. The importance of this notion is that if a is a primitive root of a prime p, then its powers a, a<sup>2</sup>, &mldr;, a<sup>p-1</sup> are distinct (mod p).
In particular, for a prime number p, if a is a primitive root of p, then
For the prime number 19, its primitive roots are 2, 3, 10, 13, 14, and 15 as we can see from the figure above. There is more complicated math around primitve roots but lets not go into that in this blog post.</p><h2 id=the-diffie-hellman-algorithm>The Diffie-Hellman Algorithm<a hidden class=anchor aria-hidden=true href=#the-diffie-hellman-algorithm>#</a></h2><p>The below figure shows the steps of diffie-hellman algorithm:</p><figure><img loading=lazy src=/images/diffieHellman/diffieHellman.png></figure><p>The idea behind the algorithm is pretty simple.</p><ol><li>First Alice and Bob agree upon a prime number q and a primitve root of q, say α such that α &lt; q.</li><li>They both generate a private key X<sub>a</sub> and X<sub>b</sub> respectively such that both the keys are smaller than q.</li><li>They both calculate their public keys Y = α<sup>X</sup> mod q and exchange that over the insecure channel.</li><li>The key exchange is now done. They both calculate the shared secret key K = Y<sup>X</sup> mod q.</li></ol><p>In order to convince ourselves that this actually works, there are a few questions we have to answer:</p><ol><li>In the first step why does α &lt; q have to be a primitive root of q.</li><li>After the calculations of public key are done and they are exchanged, how does step 4 generate the common secret key for both.</li><li>How do we ensure that the transmission of public key over the insecure channel, does not compromise the secret key in any way.</li></ol><p>If we are able to answer the above questions, we can feel confident that we understand the diffie-hellman key exchange method well enough.</p><p>So lets start with the first question. Why do we need α to be a primitve root of q and why should it be strictly smaller than q. If you look at step 3, where they both calculate their public keys, they raise α to some power (of their selected private key which can be assumed to be different) and then take a (mod q). If α is a primitive root of q (less than q), we can be sure that the generated public keys will also be distinct (from the properties of primitive root we saw above). Hence selecting α &lt; q and a primitive root of q ensures uniqueness of the generated public keys. This also makes it harder to guess the shared secret key since the keys are in a random distribution and each key has equal probablity of occuring.</p><p>For the second question, how does step 4, i.e K = Y<sup>X</sup> mod , guarantee that both Alice and Bob got the same key. The proof for that is pretty elementary and involves basic arithmatic.</p><figure><img loading=lazy src=/images/diffieHellman/dhProof.png></figure><p>Now, for the final question. What happens if someone intercepts the public keys Y<sub>A</sub> and Y<sub>B</sub> shared by Alice and Bob? Can they figure out the shared secret key?
In order to calculate the secret key X<sub>A</sub>/X<sub>B</sub>, the hacker will have to solve the discrete logarithm problem as they need to calculate X from the equation: Y = α<sup>X</sup> mod q. We have already seen above that calculating discrete log is a very hard problem and has similar complexity as factoring product of primes which is the basis of security for RSA. So we can confidently say that Diffie-Hellman is at least as secured as the RSA which is good enough for all practical purposes.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>So we now have a nice method of exchanging shared secret key securely which can be used in a lot of symmetric key encryption algorithms. Diffie-Hellman is also used in SSL/TLS, the protocols that secure web communication. So the usage is very widespread.
Combining it with RSA is also one of the common use case of Diffie-Hellman. It is used to securely exchange the shared secret key, which is then used with RSA for encryption. This provides the security of key exchange from Diffie-Hellman and the encryption strength of RSA, making it a more secure solution than either method alone.</p><p>Hopefully this blog gives you the confidence you needed to say that you understand the Diffie-Hellman Key exchange.</p><h3 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h3><ol><li>Cryptography and Network Security by William Stallings.</li><li>Introduction to Cryptography by Christof Paar (Youtube lecture)</li></ol></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://tanayjha.github.io/></a></span><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>